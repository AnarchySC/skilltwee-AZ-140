<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AZ-140 Azure Virtual Desktop Skill Tree - Quest Mode</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #050505;
            background-image: 
                radial-gradient(ellipse at top left, rgba(0, 120, 212, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at bottom right, rgba(0, 178, 148, 0.15) 0%, transparent 50%);
            min-height: 100vh;
            padding: 20px;
            color: #e2e8f0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 3em;
            font-weight: 900;
            background: linear-gradient(135deg, #0078d4 0%, #00b294 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -1px;
        }

        .cert-badge {
            text-align: center;
            margin: 20px 0;
            color: #94a3b8;
            font-size: 1.1em;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            margin: 30px 0;
            overflow: hidden;
            position: relative;
            border-radius: 100px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0078d4 0%, #00b294 100%);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 100px;
            box-shadow: 0 0 20px rgba(0, 120, 212, 0.5);
        }

        .progress-text {
            position: absolute;
            width: 100%;
            text-align: center;
            line-height: 30px;
            font-weight: 600;
            color: #94a3b8;
            font-size: 0.9em;
            top: -25px;
        }

        .skill-tree {
            display: grid;
            gap: 30px;
            margin-top: 50px;
        }

        .tier {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            padding: 25px;
            border-radius: 20px;
            position: relative;
            transition: all 0.3s ease;
        }

        .tier:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.12);
        }

        .tier-title {
            font-size: 1.3em;
            margin-bottom: 25px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 15px;
            color: #e2e8f0;
        }

        .tier-icon {
            background: linear-gradient(135deg, #0078d4 0%, #00b294 100%);
            padding: 8px 16px;
            border-radius: 10px;
            font-size: 0.9em;
            font-weight: 900;
        }

        .tier-percentage {
            margin-left: auto;
            background: rgba(0, 120, 212, 0.2);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85em;
            color: #0078d4;
            font-weight: 600;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
        }

        .skill {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 16px;
            padding: 20px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .skill::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(0, 120, 212, 0.5), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .skill:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(0, 120, 212, 0.3);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }

        .skill:hover::before {
            opacity: 1;
        }

        .skill.unlocked {
            background: linear-gradient(135deg, rgba(0, 120, 212, 0.15) 0%, rgba(0, 178, 148, 0.1) 100%);
            border: 1px solid rgba(0, 120, 212, 0.4);
            animation: unlock 0.5s ease;
        }

        .skill.unlocked::after {
            content: '✓';
            position: absolute;
            top: 10px;
            left: 10px;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #0078d4 0%, #00b294 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .skill.locked {
            opacity: 0.3;
            cursor: not-allowed;
            filter: grayscale(100%);
        }

        @keyframes unlock {
            0% { 
                transform: scale(1) rotate(0deg); 
            }
            50% { 
                transform: scale(1.05) rotate(1deg); 
            }
            100% { 
                transform: scale(1) rotate(0deg); 
            }
        }

        .skill-icon {
            font-size: 2em;
            margin-bottom: 12px;
            text-align: center;
            opacity: 0.9;
        }

        .skill-name {
            font-weight: 600;
            margin-bottom: 5px;
            text-align: center;
            font-size: 0.95em;
            color: #e2e8f0;
        }

        .skill-desc {
            font-size: 0.8em;
            opacity: 0.5;
            text-align: center;
            color: #94a3b8;
            line-height: 1.4;
        }

        .skill-points {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 120, 212, 0.2);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.7em;
            color: #0078d4;
            font-weight: 600;
        }

        .quest-indicator {
            margin-top: 10px;
            text-align: center;
            font-size: 0.75em;
            color: #00b294;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.8;
        }

        .tier-1 { 
            background: linear-gradient(135deg, rgba(0, 120, 212, 0.05) 0%, transparent 100%);
        }
        .tier-2 { 
            background: linear-gradient(135deg, rgba(0, 178, 148, 0.05) 0%, transparent 100%);
        }
        .tier-3 { 
            background: linear-gradient(135deg, rgba(128, 100, 255, 0.05) 0%, transparent 100%);
        }
        .tier-4 { 
            background: linear-gradient(135deg, rgba(255, 140, 0, 0.05) 0%, transparent 100%);
        }
        .tier-5 { 
            background: linear-gradient(135deg, rgba(232, 17, 35, 0.05) 0%, transparent 100%);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            gap: 20px;
        }

        .stat {
            text-align: center;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.06);
            flex: 1;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: 900;
            background: linear-gradient(135deg, #0078d4 0%, #00b294 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            font-size: 0.85em;
            opacity: 0.5;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 5px;
            color: #94a3b8;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }

        .modal.show {
            display: block;
        }

        .modal-content {
            background: #0a0a0a;
            background-image: 
                radial-gradient(ellipse at top, rgba(0, 120, 212, 0.1) 0%, transparent 50%);
            margin: 5% auto;
            padding: 30px;
            border: 1px solid rgba(0, 120, 212, 0.3);
            width: 90%;
            max-width: 600px;
            border-radius: 24px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            animation: modalSlide 0.3s ease;
            backdrop-filter: blur(20px);
            max-height: 80vh;
            overflow-y: auto;
        }

        @keyframes modalSlide {
            from { 
                transform: translateY(-50px) scale(0.95); 
                opacity: 0; 
            }
            to { 
                transform: translateY(0) scale(1); 
                opacity: 1; 
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-title {
            font-size: 1.4em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #e2e8f0;
        }

        .close {
            color: #94a3b8;
            font-size: 24px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            border-radius: 12px;
        }

        .close:hover {
            background: rgba(0, 120, 212, 0.2);
            border-color: rgba(0, 120, 212, 0.4);
            color: #e2e8f0;
        }

        .quest-list {
            margin: 20px 0;
        }

        .quest-section {
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.02);
            padding: 20px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .quest-section-title {
            font-weight: 600;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #0078d4 0%, #00b294 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.1em;
        }

        .quest-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .quest-item:hover {
            background: rgba(0, 120, 212, 0.05);
            border-color: rgba(0, 120, 212, 0.2);
        }

        .quest-checkbox {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            cursor: pointer;
            accent-color: #0078d4;
        }

        .quest-text {
            flex: 1;
            font-size: 0.9em;
            color: #94a3b8;
            line-height: 1.5;
        }

        .quest-item.completed .quest-text {
            text-decoration: line-through;
            opacity: 0.4;
        }

        .mastery-button {
            background: linear-gradient(135deg, #0078d4 0%, #00b294 100%);
            border: none;
            color: white;
            padding: 14px 30px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            margin-top: 20px;
            border-radius: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .mastery-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 120, 212, 0.3);
        }

        .mastery-button:disabled {
            background: rgba(255, 255, 255, 0.05);
            cursor: not-allowed;
            color: #64748b;
        }

        .resources {
            background: rgba(0, 120, 212, 0.05);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            border: 1px solid rgba(0, 120, 212, 0.1);
        }

        .resources-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: #0078d4;
        }

        .resource-link {
            display: block;
            color: #94a3b8;
            margin-bottom: 8px;
            text-decoration: none;
            font-size: 0.9em;
            transition: all 0.3s ease;
            padding-left: 15px;
            position: relative;
        }

        .resource-link:before {
            content: '→';
            position: absolute;
            left: 0;
            transition: transform 0.3s ease;
        }

        .resource-link:hover {
            color: #0078d4;
            padding-left: 20px;
        }

        .resource-link:hover:before {
            transform: translateX(5px);
        }

        .help-text {
            text-align: center;
            margin-top: 15px;
            font-size: 0.85em;
            opacity: 0.5;
            color: #94a3b8;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>☁️ AZ-140 Azure Virtual Desktop</h1>
        <div class="cert-badge">Microsoft Certified: Azure Virtual Desktop Specialty</div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
            <div class="progress-text" id="progressText">0% Complete</div>
        </div>

        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="unlockedCount">0</div>
                <div class="stat-label">Skills Unlocked</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="totalCount">25</div>
                <div class="stat-label">Total Skills</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="questsComplete">0</div>
                <div class="stat-label">Quests Complete</div>
            </div>
        </div>

        <div class="help-text">Click any skill to view learning objectives and resources</div>

        <div class="skill-tree">
            <!-- Tier 1: Plan (10-15% of exam) -->
            <div class="tier tier-1">
                <div class="tier-title">
                    <span class="tier-icon">PLAN</span>
                    Design & Architecture
                    <span class="tier-percentage">10-15%</span>
                </div>
                <div class="skills-grid">
                    <div class="skill" data-tier="1" data-skill="avd-architecture">
                        <div class="skill-points">+15 XP</div>
                        <div class="skill-icon">🏗️</div>
                        <div class="skill-name">AVD Architecture</div>
                        <div class="skill-desc">Components, deployment models, licensing</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill" data-tier="1" data-skill="network-design">
                        <div class="skill-points">+15 XP</div>
                        <div class="skill-icon">🌐</div>
                        <div class="skill-name">Network Design</div>
                        <div class="skill-desc">Connectivity, ExpressRoute, VPN, peering</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill" data-tier="1" data-skill="capacity-planning">
                        <div class="skill-points">+15 XP</div>
                        <div class="skill-icon">📊</div>
                        <div class="skill-name">Capacity Planning</div>
                        <div class="skill-desc">VM sizing, scaling, performance requirements</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill" data-tier="1" data-skill="identity-integration">
                        <div class="skill-points">+15 XP</div>
                        <div class="skill-icon">🔑</div>
                        <div class="skill-name">Identity Integration</div>
                        <div class="skill-desc">Azure AD, hybrid identity, authentication</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                </div>
            </div>

            <!-- Tier 2: Implement (25-30% of exam) -->
            <div class="tier tier-2">
                <div class="tier-title">
                    <span class="tier-icon">BUILD</span>
                    Implementation
                    <span class="tier-percentage">25-30%</span>
                </div>
                <div class="skills-grid">
                    <div class="skill locked" data-tier="2" data-skill="host-pools">
                        <div class="skill-points">+20 XP</div>
                        <div class="skill-icon">🖥️</div>
                        <div class="skill-name">Host Pools</div>
                        <div class="skill-desc">Create, configure, pooled vs personal</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="2" data-skill="session-hosts">
                        <div class="skill-points">+20 XP</div>
                        <div class="skill-icon">💻</div>
                        <div class="skill-name">Session Hosts</div>
                        <div class="skill-desc">Deploy VMs, golden images, Shared Image Gallery</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="2" data-skill="workspaces">
                        <div class="skill-points">+20 XP</div>
                        <div class="skill-icon">🗂️</div>
                        <div class="skill-name">Workspaces</div>
                        <div class="skill-desc">Application groups, RemoteApp, desktop</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="2" data-skill="storage-solutions">
                        <div class="skill-points">+20 XP</div>
                        <div class="skill-icon">💾</div>
                        <div class="skill-name">Storage Solutions</div>
                        <div class="skill-desc">FSLogix, Azure Files, NetApp Files</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="2" data-skill="networking">
                        <div class="skill-points">+20 XP</div>
                        <div class="skill-icon">🔌</div>
                        <div class="skill-name">Networking Config</div>
                        <div class="skill-desc">NSGs, Azure Firewall, RDP Shortpath</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                </div>
            </div>

            <!-- Tier 3: Manage Access (10-15% of exam) -->
            <div class="tier tier-3">
                <div class="tier-title">
                    <span class="tier-icon">ACCESS</span>
                    User Access & Security
                    <span class="tier-percentage">10-15%</span>
                </div>
                <div class="skills-grid">
                    <div class="skill locked" data-tier="3" data-skill="rbac">
                        <div class="skill-points">+25 XP</div>
                        <div class="skill-icon">🛡️</div>
                        <div class="skill-name">RBAC & Permissions</div>
                        <div class="skill-desc">Roles, assignments, least privilege</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="3" data-skill="conditional-access">
                        <div class="skill-points">+25 XP</div>
                        <div class="skill-icon">🔐</div>
                        <div class="skill-name">Conditional Access</div>
                        <div class="skill-desc">MFA, policies, device compliance</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="3" data-skill="app-management">
                        <div class="skill-points">+25 XP</div>
                        <div class="skill-icon">📱</div>
                        <div class="skill-name">App Management</div>
                        <div class="skill-desc">MSIX app attach, RemoteApp delivery</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="3" data-skill="user-profiles">
                        <div class="skill-points">+25 XP</div>
                        <div class="skill-icon">👤</div>
                        <div class="skill-name">User Profiles</div>
                        <div class="skill-desc">FSLogix profiles, containers, Office containers</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="3" data-skill="device-redirection">
                        <div class="skill-points">+25 XP</div>
                        <div class="skill-icon">🔄</div>
                        <div class="skill-name">Device Redirection</div>
                        <div class="skill-desc">USB, printers, drives, clipboard</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                </div>
            </div>

            <!-- Tier 4: Manage (25-30% of exam) -->
            <div class="tier tier-4">
                <div class="tier-title">
                    <span class="tier-icon">MANAGE</span>
                    Operations & Management
                    <span class="tier-percentage">25-30%</span>
                </div>
                <div class="skills-grid">
                    <div class="skill locked" data-tier="4" data-skill="automation">
                        <div class="skill-points">+30 XP</div>
                        <div class="skill-icon">🤖</div>
                        <div class="skill-name">Automation</div>
                        <div class="skill-desc">ARM templates, PowerShell, Azure CLI, Bicep</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="4" data-skill="scaling">
                        <div class="skill-points">+30 XP</div>
                        <div class="skill-icon">📈</div>
                        <div class="skill-name">Autoscaling</div>
                        <div class="skill-desc">Scaling plans, peak hours, depth/breadth-first</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="4" data-skill="updates">
                        <div class="skill-points">+30 XP</div>
                        <div class="skill-icon">🔄</div>
                        <div class="skill-name">Updates & Maintenance</div>
                        <div class="skill-desc">Windows Updates, image updates, drain mode</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="4" data-skill="backup-dr">
                        <div class="skill-points">+30 XP</div>
                        <div class="skill-icon">💾</div>
                        <div class="skill-name">Backup & DR</div>
                        <div class="skill-desc">Azure Backup, Site Recovery, business continuity</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="4" data-skill="cost-management">
                        <div class="skill-points">+30 XP</div>
                        <div class="skill-icon">💰</div>
                        <div class="skill-name">Cost Management</div>
                        <div class="skill-desc">Reserved instances, cost analysis, optimization</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                </div>
            </div>

            <!-- Tier 5: Monitor (20-25% of exam) -->
            <div class="tier tier-5">
                <div class="tier-title">
                    <span class="tier-icon">MONITOR</span>
                    Monitoring & Troubleshooting
                    <span class="tier-percentage">20-25%</span>
                </div>
                <div class="skills-grid">
                    <div class="skill locked" data-tier="5" data-skill="azure-monitor">
                        <div class="skill-points">+35 XP</div>
                        <div class="skill-icon">📊</div>
                        <div class="skill-name">Azure Monitor</div>
                        <div class="skill-desc">Insights, workbooks, Log Analytics</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="5" data-skill="diagnostics">
                        <div class="skill-points">+35 XP</div>
                        <div class="skill-icon">🔍</div>
                        <div class="skill-name">Diagnostics</div>
                        <div class="skill-desc">Diagnostic settings, logs, performance counters</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="5" data-skill="alerts">
                        <div class="skill-points">+35 XP</div>
                        <div class="skill-icon">🚨</div>
                        <div class="skill-name">Alerts & Actions</div>
                        <div class="skill-desc">Alert rules, action groups, notifications</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="5" data-skill="performance">
                        <div class="skill-points">+35 XP</div>
                        <div class="skill-icon">⚡</div>
                        <div class="skill-name">Performance Tuning</div>
                        <div class="skill-desc">Optimization, GPU, Teams optimization</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="5" data-skill="troubleshooting">
                        <div class="skill-points">+35 XP</div>
                        <div class="skill-icon">🔧</div>
                        <div class="skill-name">Troubleshooting</div>
                        <div class="skill-desc">Connection issues, performance problems</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                    <div class="skill locked" data-tier="5" data-skill="security-monitoring">
                        <div class="skill-points">+35 XP</div>
                        <div class="skill-icon">🛡️</div>
                        <div class="skill-name">Security Monitoring</div>
                        <div class="skill-desc">Defender for Cloud, Sentinel integration</div>
                        <div class="quest-indicator">📋 View Quests</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quest Modal -->
    <div id="questModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">
                    <span id="modalIcon">☁️</span>
                    <span id="modalSkillName">Skill Name</span>
                </div>
                <span class="close">&times;</span>
            </div>
            <div id="questContent"></div>
        </div>
    </div>

    <script>
        // Complete skill quest data embedded
        const skillQuests = {
            'avd-architecture': {
                icon: '🏗️',
                quests: {
                    'Understand Core Concepts': [
                        'Explain the AVD architecture components (control plane, data plane)',
                        'Understand workspace, host pool, and app group relationships',
                        'Know the difference between pooled and personal desktop types',
                        'Understand load balancing algorithms (breadth-first, depth-first)',
                        'Explain RemoteApp vs full desktop deployment scenarios'
                    ],
                    'Plan Requirements': [
                        'Determine licensing requirements (M365, Windows, CAL)',
                        'Plan for multi-session vs single-session hosts',
                        'Design for different user personas and workload types',
                        'Calculate Azure consumption costs',
                        'Plan for Azure region selection and availability'
                    ],
                    'Hands-on Practice': [
                        'Create a basic AVD proof of concept',
                        'Document an AVD architecture diagram',
                        'Compare pricing for different scenarios'
                    ]
                },
                resources: [
                    { name: 'MS Learn - AVD Architecture', url: 'https://learn.microsoft.com/en-us/training/modules/azure-virtual-desktop-architecture/' },
                    { name: 'AVD Documentation', url: 'https://learn.microsoft.com/en-us/azure/virtual-desktop/' },
                    { name: 'AVD Pricing Calculator', url: 'https://azure.microsoft.com/en-us/pricing/calculator/' }
                ]
            },
            // Add simplified versions for other skills - full data would make this too long
            'network-design': { icon: '🌐', quests: { 'Network Tasks': ['Design network topology', 'Configure connectivity'] }, resources: [] },
            'capacity-planning': { icon: '📊', quests: { 'Capacity Tasks': ['Size VMs', 'Plan scaling'] }, resources: [] },
            'identity-integration': { icon: '🔑', quests: { 'Identity Tasks': ['Configure Azure AD', 'Set up authentication'] }, resources: [] },
            'host-pools': { icon: '🖥️', quests: { 'Host Pool Tasks': ['Create host pools', 'Configure settings'] }, resources: [] },
            'session-hosts': { icon: '💻', quests: { 'Session Tasks': ['Deploy VMs', 'Configure images'] }, resources: [] },
            'workspaces': { icon: '🗂️', quests: { 'Workspace Tasks': ['Create workspaces', 'Assign apps'] }, resources: [] },
            'storage-solutions': { icon: '💾', quests: { 'Storage Tasks': ['Configure FSLogix', 'Set up Azure Files'] }, resources: [] },
            'networking': { icon: '🔌', quests: { 'Network Tasks': ['Configure NSGs', 'Set up firewall'] }, resources: [] },
            'rbac': { icon: '🛡️', quests: { 'RBAC Tasks': ['Configure roles', 'Set permissions'] }, resources: [] },
            'conditional-access': { icon: '🔐', quests: { 'Access Tasks': ['Create policies', 'Configure MFA'] }, resources: [] },
            'app-management': { icon: '📱', quests: { 'App Tasks': ['Configure MSIX', 'Publish apps'] }, resources: [] },
            'user-profiles': { icon: '👤', quests: { 'Profile Tasks': ['Configure FSLogix', 'Set containers'] }, resources: [] },
            'device-redirection': { icon: '🔄', quests: { 'Device Tasks': ['Configure USB', 'Set up printers'] }, resources: [] },
            'automation': { icon: '🤖', quests: { 'Automation Tasks': ['Create templates', 'Write scripts'] }, resources: [] },
            'scaling': { icon: '📈', quests: { 'Scaling Tasks': ['Create plans', 'Configure schedules'] }, resources: [] },
            'updates': { icon: '🔄', quests: { 'Update Tasks': ['Configure updates', 'Manage patches'] }, resources: [] },
            'backup-dr': { icon: '💾', quests: { 'Backup Tasks': ['Set up backup', 'Plan DR'] }, resources: [] },
            'cost-management': { icon: '💰', quests: { 'Cost Tasks': ['Analyze costs', 'Optimize spending'] }, resources: [] },
            'azure-monitor': { icon: '📊', quests: { 'Monitor Tasks': ['Configure monitoring', 'Create dashboards'] }, resources: [] },
            'diagnostics': { icon: '🔍', quests: { 'Diagnostic Tasks': ['Enable logging', 'Analyze logs'] }, resources: [] },
            'alerts': { icon: '🚨', quests: { 'Alert Tasks': ['Create alerts', 'Configure actions'] }, resources: [] },
            'performance': { icon: '⚡', quests: { 'Performance Tasks': ['Optimize performance', 'Configure GPU'] }, resources: [] },
            'troubleshooting': { icon: '🔧', quests: { 'Troubleshoot Tasks': ['Fix connections', 'Resolve issues'] }, resources: [] },
            'security-monitoring': { icon: '🛡️', quests: { 'Security Tasks': ['Configure Defender', 'Monitor threats'] }, resources: [] }
        };

        // Main application state
        let unlockedSkills = {};
        let questProgress = {};
        let currentSkill = null;

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Initializing AZ-140 Skill Tree...');
            initSkillTree();
        });

        function initSkillTree() {
            // Load saved progress
            const savedSkills = localStorage.getItem('az140SkillTree');
            const savedQuests = localStorage.getItem('az140QuestProgress');
            
            if (savedSkills) {
                try {
                    unlockedSkills = JSON.parse(savedSkills);
                } catch (e) {
                    console.error('Error loading saved skills:', e);
                }
            }
            
            if (savedQuests) {
                try {
                    questProgress = JSON.parse(savedQuests);
                } catch (e) {
                    console.error('Error loading saved quests:', e);
                }
            }
            
            updateProgress();
            restoreUnlockedSkills();
            setupEventListeners();
            updateQuestCount();
        }

        function setupEventListeners() {
            // Add click listeners to all skills
            document.querySelectorAll('.skill').forEach(skill => {
                skill.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const skillId = this.dataset.skill;
                    console.log('Skill clicked:', skillId);
                    openQuestModal(skillId);
                });
            });

            // Close modal
            const closeBtn = document.querySelector('.close');
            if (closeBtn) {
                closeBtn.addEventListener('click', closeModal);
            }
            
            // Close on outside click
            window.addEventListener('click', function(e) {
                const modal = document.getElementById('questModal');
                if (e.target === modal) {
                    closeModal();
                }
            });
        }

        function openQuestModal(skillId) {
            currentSkill = skillId;
            const modal = document.getElementById('questModal');
            const skillData = skillQuests[skillId];
            
            if (!skillData) {
                alert('Quest data not configured for this skill yet!');
                return;
            }

            // Update modal header
            document.getElementById('modalIcon').textContent = skillData.icon;
            const skillElement = document.querySelector(`[data-skill="${skillId}"]`);
            document.getElementById('modalSkillName').textContent = skillElement.querySelector('.skill-name').textContent;

            // Build quest content
            let questHTML = '<div class="quest-list">';
            
            // Add quests
            Object.keys(skillData.quests).forEach(section => {
                questHTML += `<div class="quest-section">
                    <div class="quest-section-title">✅ ${section}</div>`;
                
                skillData.quests[section].forEach((quest, index) => {
                    const questId = `${skillId}-${section}-${index}`;
                    const isCompleted = questProgress[questId] || false;
                    
                    questHTML += `
                        <div class="quest-item ${isCompleted ? 'completed' : ''}" data-quest-id="${questId}">
                            <input type="checkbox" class="quest-checkbox" ${isCompleted ? 'checked' : ''}>
                            <span class="quest-text">${quest}</span>
                        </div>`;
                });
                questHTML += '</div>';
            });

            // Add resources if available
            if (skillData.resources && skillData.resources.length > 0) {
                questHTML += '<div class="resources"><div class="resources-title">📚 Learning Resources:</div>';
                skillData.resources.forEach(resource => {
                    questHTML += `<a href="${resource.url}" class="resource-link" target="_blank">→ ${resource.name}</a>`;
                });
                questHTML += '</div>';
            }

            // Add mastery button
            const allQuests = getAllQuestsForSkill(skillId);
            const completedQuests = allQuests.filter(qId => questProgress[qId]).length;
            const isComplete = completedQuests === allQuests.length && allQuests.length > 0;
            
            questHTML += `
                <button class="mastery-button" ${!isComplete ? 'disabled' : ''} id="masteryBtn">
                    ${unlockedSkills[skillId] ? '✅ Skill Mastered!' : 'Mark as Mastered'} 
                    (${completedQuests}/${allQuests.length} quests)
                </button>
            </div>`;

            document.getElementById('questContent').innerHTML = questHTML;

            // Add event listeners
            document.querySelectorAll('.quest-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', handleQuestToggle);
            });

            const masteryBtn = document.getElementById('masteryBtn');
            if (masteryBtn) {
                masteryBtn.addEventListener('click', handleMastery);
            }

            // Show modal
            modal.classList.add('show');
        }

        function handleQuestToggle(e) {
            const questItem = e.target.closest('.quest-item');
            const questId = questItem.dataset.questId;
            
            questProgress[questId] = e.target.checked;
            questItem.classList.toggle('completed', e.target.checked);
            
            localStorage.setItem('az140QuestProgress', JSON.stringify(questProgress));
            
            // Update mastery button
            const allQuests = getAllQuestsForSkill(currentSkill);
            const completedQuests = allQuests.filter(qId => questProgress[qId]).length;
            const isComplete = completedQuests === allQuests.length && allQuests.length > 0;
            
            const masteryBtn = document.getElementById('masteryBtn');
            if (masteryBtn) {
                masteryBtn.disabled = !isComplete;
                masteryBtn.textContent = `${unlockedSkills[currentSkill] ? '✅ Skill Mastered!' : 'Mark as Mastered'} (${completedQuests}/${allQuests.length} quests)`;
            }
            
            updateQuestCount();
        }

        function getAllQuestsForSkill(skillId) {
            const skillData = skillQuests[skillId];
            if (!skillData || !skillData.quests) return [];
            
            const questIds = [];
            Object.keys(skillData.quests).forEach(section => {
                skillData.quests[section].forEach((_, index) => {
                    questIds.push(`${skillId}-${section}-${index}`);
                });
            });
            return questIds;
        }

        function handleMastery() {
            const skillElement = document.querySelector(`[data-skill="${currentSkill}"]`);
            
            if (!unlockedSkills[currentSkill]) {
                unlockedSkills[currentSkill] = true;
                skillElement.classList.add('unlocked');
            } else {
                unlockedSkills[currentSkill] = false;
                skillElement.classList.remove('unlocked');
            }
            
            localStorage.setItem('az140SkillTree', JSON.stringify(unlockedSkills));
            updateProgress();
            
            const masteryBtn = document.getElementById('masteryBtn');
            if (masteryBtn) {
                masteryBtn.textContent = unlockedSkills[currentSkill] ? '✅ Skill Mastered!' : 'Mark as Mastered';
            }
        }

        function closeModal() {
            const modal = document.getElementById('questModal');
            if (modal) {
                modal.classList.remove('show');
            }
            currentSkill = null;
        }

        function restoreUnlockedSkills() {
            Object.keys(unlockedSkills).forEach(skillId => {
                const skillElement = document.querySelector(`[data-skill="${skillId}"]`);
                if (skillElement && unlockedSkills[skillId]) {
                    skillElement.classList.add('unlocked');
                }
            });
        }

        function updateProgress() {
            const totalSkills = document.querySelectorAll('.skill').length;
            const unlockedCount = Object.values(unlockedSkills).filter(v => v).length;
            const percentage = Math.round((unlockedCount / totalSkills) * 100);
            
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressText').textContent = percentage + '% Complete';
            document.getElementById('unlockedCount').textContent = unlockedCount;
            document.getElementById('totalCount').textContent = totalSkills;
        }

        function updateQuestCount() {
            const totalQuests = Object.keys(questProgress).filter(k => questProgress[k]).length;
            document.getElementById('questsComplete').textContent = totalQuests;
        }
    </script>
</body>
</html>
